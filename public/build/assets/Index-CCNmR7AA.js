import{r,v as L,j as e,q as Q,$ as V,Y as W}from"./app-BO4aS4VV.js";import{N as P,D as X,a as Z}from"./Notification-CE1hsZqh.js";import{d as f}from"./index-BTZty7Ay.js";import{S as ee,a as te,B as se,P as ae}from"./ButtonShort-BMHvg6Fk.js";import{P as re}from"./PrimaryButton-DFDVG6GL.js";import{S as le}from"./ShareModal-BixkgqME.js";import{I as w}from"./iconify-4cTnymJz.js";/* empty css            */import"./index-C158x22U.js";function oe({show:s,onClose:h}){const[m,d]=r.useState(null),{data:o,setData:p,post:u,processing:i,errors:c,reset:g,clearErrors:j}=L({original_url:"",custom_alias:"",expires_at:""});if(!s)return null;const x=()=>{g(),j(),d(null),h()},b=l=>{l.preventDefault(),d(null),u(route("shorten.store"),{onSuccess:()=>{d({type:"success",message:"Shortened successfully."}),g(),j(),h()},onError:()=>{d({type:"error",message:"An error occurred, please check your input."})}})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-5",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm md:max-w-2xl p-5 md:p-10 relative",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex flex-row",children:[e.jsx("img",{src:"/images/Hyperlink.png",style:{width:"24px",height:"24px"},alt:"hyperlink"}),e.jsx("h2",{className:"text-sm md:text-xl ms-4 font-semibold text-primary-100 mb-4",children:"Shortened Link"})]}),e.jsx("button",{onClick:x,className:"text-foreground font-black hover:text-primary-100 w-2 h-2 md:w-4 md:h-4",children:"âœ•"})]}),m&&e.jsx(P,{type:m.type,message:m.message,onClose:()=>d(null)}),e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Long URL"}),e.jsx("input",{type:"url",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1",placeholder:"https://example.com/",name:"original_url",value:o.original_url,onChange:l=>p("original_url",l.target.value),required:!0}),c.original_url&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:c.original_url})]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:gap-0",children:[e.jsxs("div",{className:"w-full md:basis-3/4 md:me-4",children:[e.jsx("label",{className:"text-sm text-foreground",children:"Short URL"}),e.jsx("input",{type:"text",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",value:`${window.location.host}/s/`,readOnly:!0})]}),e.jsxs("div",{className:"w-full md:basis-3/4",children:[e.jsx("label",{className:"text-sm text-foreground",children:"Alias"}),e.jsx("input",{type:"text",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",placeholder:"custom-alias",name:"custom_alias",value:o.custom_alias,onChange:l=>p("custom_alias",l.target.value)}),c.custom_alias&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:c.custom_alias})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Expiration Date"}),e.jsx("input",{type:"date",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1",name:"expires_at",value:o.expires_at,onChange:l=>p("expires_at",l.target.value),required:!0}),c.expires_at&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:c.expires_at})]}),e.jsx(re,{type:"submit",disabled:i,children:i?"Shortened Link...":"Shortened Link"})]})})]})})}function ge({shortends:s}){const{success:h}=Q().props,[m,d]=r.useState(""),[o,p]=r.useState(!1),[u,i]=r.useState([]),[c,g]=r.useState(!1),[j,x]=r.useState(!1),[b,l]=r.useState(null),[E,v]=r.useState(!1),[$,I]=r.useState(""),[N,n]=r.useState(null),[S,U]=r.useState(Number(new URLSearchParams(window.location.search).get("perPage"))||10);r.useEffect(()=>{h&&(n({type:"success",message:h}),f.Inertia.replace(window.location.pathname+window.location.search))},[h]);const{data:A,setData:M,post:_,processing:T,errors:B,reset:k}=L({original_url:"",custom_alias:"",expires_at:""}),C=t=>{if(!t)return"Active";const a=new Date;return new Date(t)<a?"Expired":"Active"},O=t=>{t.preventDefault(),_("/shorten.store",{onSuccess:()=>{g(!1),k()}})},R=t=>{i(a=>a.includes(t)?a.filter(y=>y!==t):[...a,t])},q=t=>{l(t),x(!0)},F=()=>{b?f.Inertia.delete(`/shorten/${b.id}`,{onSuccess:()=>{x(!1),l(null),n({type:"success",message:"Link deleted successfully."})},onError:()=>{n({type:"error",message:"Failed to delete link. Please try again."}),x(!1),l(null)},preserveScroll:!0}):x(!1)},z=()=>{if(u.length===0){n({type:"error",message:"No links selected."});return}window.confirm("Are you sure you want to delete selected links?")&&f.Inertia.post("/shorten/bulk-delete",{ids:u,_method:"DELETE"},{onSuccess:()=>{n({type:"success",message:"Selected links deleted successfully."}),i([]),p(!1)},onError:()=>{n({type:"error",message:"Failed to delete selected links."})},preserveScroll:!0})},Y=t=>{const a=`${window.location.origin}/s/${t.short_code}`;navigator.clipboard.writeText(a).then(()=>{n({type:"success",message:"Link copied to clipboard!"})}).catch(()=>{n({type:"error",message:"Failed to copy the link."})})},H=t=>{const a=`${window.location.origin}/s/${t.short_code}`;I(a),v(!0)},G=t=>{f.Inertia.get("/shorten",{page:t,perPage:S,search:m},{preserveState:!0,replace:!0})},J=t=>{U(t),f.Inertia.get("/shorten",{page:1,perPage:t,search:m},{preserveState:!0,replace:!0})},K=t=>{d(t),f.Inertia.get("/shorten",{page:1,perPage:S,search:t},{preserveState:!0,replace:!0})};return e.jsxs(X,{children:[e.jsx(V,{title:"Shortened Links"}),e.jsxs("div",{className:"py-5",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-primary-100",children:"Shortened Link"}),e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-5 my-3",children:[e.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"List Shortened Link"}),e.jsxs("div",{className:"flex items-center gap-3 transition-all duration-300 ease-in-out flex-wrap",children:[e.jsx("div",{className:"transition-all duration-300",children:e.jsx(ee,{onClick:()=>g(!0)})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsx(te,{onSearch:K})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsx(se,{isActive:o,toggleBulkMode:()=>{p(!o),i([])},onDelete:z})})]})]}),N&&e.jsx(P,{type:N.type,message:N.message,onClose:()=>n(null)}),e.jsx("div",{className:"overflow-x-auto bg-white shadow rounded-2xl",children:e.jsxs("table",{className:"min-w-full text-left border-collapse text-sm  md:text-[16px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-muted hover:bg-gray-50",children:[o&&e.jsx("th",{className:"px-4 py-6",children:e.jsx("input",{type:"checkbox",checked:u.length===s.data.length&&s.data.length>0,onChange:t=>{t.target.checked?i(s.data.map(a=>a.id)):i([])}})}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"URL"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Date Created"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Expiration Date"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:s.data.length>0?s.data.map(t=>{var a,y;return e.jsxs("tr",{className:"border-b border-muted hover:bg-gray-50",children:[o&&e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:u.includes(t.id),onChange:()=>R(t.id)})}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap flex items-center gap-2 w-full max-w-full md:max-w-[560px] overflow-hidden",children:[e.jsx("img",{src:`https://www.google.com/s2/favicons?sz=64&domain=${new URL(t.original_url).hostname}`,alt:"favicon",className:"w-8 h-8 rounded-full bg-gray-100 object-contain",style:{flexShrink:0},onError:D=>{D.currentTarget.onerror=null,D.currentTarget.src="https://cdn-icons-png.flaticon.com/512/565/565547.png"}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("a",{href:`${window.location.origin}/s/${t.short_code}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-foreground hover:underline block overflow-hidden text-ellipsis whitespace-nowrap",children:`${window.location.origin}/s/${t.short_code}`}),e.jsx("a",{href:t.original_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-foreground break-all hover:underline block",title:t.original_url,children:t.original_url.length>60?`${t.original_url.slice(0,60)}...`:t.original_url})]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:(a=t.created_at)==null?void 0:a.slice(0,10)}),e.jsx("td",{className:"px-4 py-4",children:(y=t.expires_at)==null?void 0:y.slice(0,10)}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${C(t.expires_at)==="Expired"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:C(t.expires_at)})}),e.jsxs("td",{className:"px-4 py-4 flex space-x-2 text-lg text-gray-700",children:[e.jsx("button",{title:"Copy",onClick:()=>Y(t),className:"hover:text-primary-100",children:e.jsx(w,{icon:"akar-icons:copy",width:20,height:20})}),e.jsx(W,{href:`/shorten/${t.id}/edit`,title:"Edit",className:"hover:text-primary-100",children:e.jsx(w,{icon:"iconamoon:edit-light",width:20,height:20})}),e.jsx("button",{title:"Delete",onClick:()=>q(t),className:"hover:text-primary-100",children:e.jsx(w,{icon:"gravity-ui:trash-bin",width:20,height:20})}),e.jsx("button",{title:"Share",onClick:()=>H(t),className:"hover:text-primary-100",children:e.jsx(w,{icon:"tabler:share",width:20,height:20})})]})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:o?6:5,className:"px-4 py-6 text-center text-gray-500",children:"No links available yet."})})})]})}),e.jsx(ae,{pagination:{current_page:s.current_page,last_page:s.last_page,from:s.from,to:s.to,total:s.total,prev_page_url:s.prev_page_url,next_page_url:s.next_page_url},perPage:S,onPageChange:G,onPerPageChange:J}),j&&e.jsx(Z,{isOpen:j,onClose:()=>x(!1),onConfirm:F}),E&&e.jsx(le,{url:$,onClose:()=>v(!1)}),e.jsx(oe,{show:c,onClose:()=>g(!1),onSubmit:O,data:A,setData:M,errors:B,processing:T,post:_,reset:k})]})]})}export{ge as default};
