import{j as e,r as o,u as I,c as J,b as Q,H as V,L as Y}from"./app-CL3xyi0u.js";import{D as Z}from"./DashboardLayout-BfzmEYb1.js";import{d as y}from"./index-DQ1NuDG1.js";import{S as ee,a as te,B as se,P as re}from"./ButtonShort-CDpl3A1X.js";import{P as ae}from"./PrimaryButton-MSExsVs6.js";import{N as A}from"./Notification-DEuHDJOw.js";import{D as le}from"./DeleteModal-DXTT1HM6.js";import{S as oe}from"./ShareModal-DHw3Ylx_.js";import{I as S}from"./iconify-CJWKapRj.js";/* empty css            */import"./index-DtrrT7rv.js";function ne({className:r="",disabled:u,loading:c=!1,children:n="AI Suggest",...m}){return e.jsx("button",{...m,disabled:u||c,className:`w-full flex justify-center items-center rounded-lg border border-transparent bg-primary-100 px-4 py-3 text-sm font-semibold text-white transition duration-150 ease-in-out hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 
                 ${u||c?"opacity-50 cursor-not-allowed":""} `+r,children:c?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),"Generating..."]}):n})}function ie({show:r,onClose:u}){const[c,n]=o.useState(null),[m,j]=o.useState(!1),[p,x]=o.useState(!1),{data:h,setData:d,post:b,processing:g,errors:i,reset:f,clearErrors:N}=I({original_url:"",custom_alias:"",expires_at:"",password:""});if(!r)return null;const v=()=>{f(),N(),n(null),x(!1),u()},_=s=>{s.preventDefault(),n(null),p||d("password",""),b(route("shorten.store"),{onSuccess:()=>{n({type:"success",message:"Shortened successfully."}),f(),N(),x(!1),u()},onError:()=>{n({type:"error",message:"An error occurred, please check your input."})}})},k=async()=>{var s;if(!h.original_url){n({type:"error",message:"Isi Long URL dulu!"});return}try{j(!0);const a=await J.post("/ai/slug",{url:h.original_url},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});(s=a.data)!=null&&s.slug?(d("custom_alias",a.data.slug),n({type:"success",message:"AI successfully generated slug."})):n({type:"error",message:"AI does not return slugs."})}catch(a){console.error(a),n({type:"error",message:"Failed to generate slug from AI."})}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-5",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm md:max-w-2xl p-5 md:p-10 relative",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex flex-row",children:[e.jsx("img",{src:"/images/Hyperlink.png",style:{width:"24px",height:"24px"},alt:"hyperlink"}),e.jsx("h2",{className:"text-sm md:text-xl ms-4 font-semibold text-primary-100 mb-4",children:"Shortened Link"})]}),e.jsx("button",{onClick:v,className:"text-foreground font-black hover:text-primary-100 w-2 h-2 md:w-4 md:h-4",children:"âœ•"})]}),c&&e.jsx(A,{type:c.type,message:c.message,onClose:()=>n(null)}),e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Long URL"}),e.jsx("input",{type:"url",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1",placeholder:"https://example.com/",name:"original_url",value:h.original_url,onChange:s=>d("original_url",s.target.value),required:!0}),i.original_url&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.original_url})]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:gap-0",children:[e.jsxs("div",{className:"w-full md:basis-3/4 md:me-4",children:[e.jsx("label",{className:"text-sm text-foreground",children:"Short URL"}),e.jsx("input",{type:"text",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",value:`${window.location.host}/s/`,readOnly:!0})]}),e.jsxs("div",{className:"w-full md:basis-3/4",children:[e.jsx("label",{className:"text-sm text-foreground",children:"Alias"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",placeholder:"custom-alias",name:"custom_alias",value:h.custom_alias,onChange:s=>d("custom_alias",s.target.value)}),e.jsx(ne,{onClick:k,loading:m,className:"mt-1"})]}),i.custom_alias&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.custom_alias})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Expiration Date"}),e.jsx("input",{type:"date",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1",name:"expires_at",value:h.expires_at,onChange:s=>d("expires_at",s.target.value),required:!0}),i.expires_at&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.expires_at})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-foreground",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:s=>x(s.target.checked)}),"Protect with Password?"]}),p&&e.jsx("input",{type:"password",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-2",placeholder:"Enter password",name:"password",value:h.password,onChange:s=>d("password",s.target.value)}),i.password&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:i.password})]}),e.jsx(ae,{type:"submit",disabled:g,children:g?"Shortened Link...":"Shortened Link"})]})})]})})}function we({shortends:r}){const{success:u}=Q().props,[c,n]=o.useState(""),[m,j]=o.useState(!1),[p,x]=o.useState([]),[h,d]=o.useState(!1),[b,g]=o.useState(!1),[i,f]=o.useState(null),[N,v]=o.useState(!1),[_,k]=o.useState(""),[s,a]=o.useState(null),[C,$]=o.useState(Number(new URLSearchParams(window.location.search).get("perPage"))||10);o.useEffect(()=>{u&&(a({type:"success",message:u}),y.Inertia.replace(window.location.pathname+window.location.search))},[u]);const{data:U,setData:B,post:D,processing:M,errors:T,reset:L}=I({original_url:"",custom_alias:"",expires_at:""}),P=t=>{if(!t)return"Active";const l=new Date;return new Date(t)<l?"Expired":"Active"},R=t=>{t.preventDefault(),D("/shorten.store",{onSuccess:()=>{d(!1),L()}})},O=t=>{x(l=>l.includes(t)?l.filter(w=>w!==t):[...l,t])},F=t=>{f(t),g(!0)},H=()=>{i?y.Inertia.delete(`/shorten/${i.id}`,{onSuccess:()=>{g(!1),f(null),a({type:"success",message:"Link deleted successfully."})},onError:()=>{a({type:"error",message:"Failed to delete link. Please try again."}),g(!1),f(null)},preserveScroll:!0}):g(!1)},q=()=>{if(p.length===0){a({type:"error",message:"No links selected."});return}window.confirm("Are you sure you want to delete selected links?")&&y.Inertia.post("/shorten/bulk-delete",{ids:p,_method:"DELETE"},{onSuccess:()=>{a({type:"success",message:"Selected links deleted successfully."}),x([]),j(!1)},onError:()=>{a({type:"error",message:"Failed to delete selected links."})},preserveScroll:!0})},z=t=>{const l=`${window.location.origin}/s/${t.short_code}`;navigator.clipboard.writeText(l).then(()=>{a({type:"success",message:"Link copied to clipboard!"})}).catch(()=>{a({type:"error",message:"Failed to copy the link."})})},G=t=>{const l=`${window.location.origin}/s/${t.short_code}`;k(l),v(!0)},K=t=>{y.Inertia.get("/shorten",{page:t,perPage:C,search:c},{preserveState:!0,replace:!0})},W=t=>{$(t),y.Inertia.get("/shorten",{page:1,perPage:t,search:c},{preserveState:!0,replace:!0})},X=t=>{n(t),y.Inertia.get("/shorten",{page:1,perPage:C,search:t},{preserveState:!0,replace:!0})};return e.jsxs(Z,{children:[e.jsx(V,{title:"Shortened Links"}),e.jsxs("div",{className:"py-5",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-primary-100",children:"Shortened Link"}),e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-5 my-3",children:[e.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"List Shortened Link"}),e.jsxs("div",{className:"flex items-center gap-3 transition-all duration-300 ease-in-out flex-wrap",children:[e.jsx("div",{className:"transition-all duration-300",children:e.jsx(ee,{onClick:()=>d(!0)})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsx(te,{onSearch:X})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsx(se,{isActive:m,toggleBulkMode:()=>{j(!m),x([])},onDelete:q})})]})]}),s&&e.jsx(A,{type:s.type,message:s.message,onClose:()=>a(null)}),e.jsx("div",{className:"overflow-x-auto bg-white shadow rounded-2xl",children:e.jsxs("table",{className:"min-w-full text-left border-collapse text-sm  md:text-[16px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-muted hover:bg-gray-50",children:[m&&e.jsx("th",{className:"px-4 py-6",children:e.jsx("input",{type:"checkbox",checked:p.length===r.data.length&&r.data.length>0,onChange:t=>{t.target.checked?x(r.data.map(l=>l.id)):x([])}})}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"URL"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Date Created"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Expiration Date"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:r.data.length>0?r.data.map(t=>{var l,w;return e.jsxs("tr",{className:"border-b border-muted hover:bg-gray-50",children:[m&&e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:p.includes(t.id),onChange:()=>O(t.id)})}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap flex items-center gap-2 w-full max-w-full md:max-w-[560px] overflow-hidden",children:[e.jsx("img",{src:`https://www.google.com/s2/favicons?sz=64&domain=${new URL(t.original_url).hostname}`,alt:"favicon",className:"w-8 h-8 rounded-full bg-gray-100 object-contain",style:{flexShrink:0},onError:E=>{E.currentTarget.onerror=null,E.currentTarget.src="https://cdn-icons-png.flaticon.com/512/565/565547.png"}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("a",{href:`${window.location.origin}/s/${t.short_code}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-foreground hover:underline block overflow-hidden text-ellipsis whitespace-nowrap",children:`${window.location.origin}/s/${t.short_code}`}),e.jsx("a",{href:t.original_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-foreground break-all hover:underline block",title:t.original_url,children:t.original_url.length>60?`${t.original_url.slice(0,60)}...`:t.original_url})]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:(l=t.created_at)==null?void 0:l.slice(0,10)}),e.jsx("td",{className:"px-4 py-4",children:(w=t.expires_at)==null?void 0:w.slice(0,10)}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${P(t.expires_at)==="Expired"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:P(t.expires_at)})}),e.jsxs("td",{className:"px-4 py-4 flex space-x-2 text-lg text-gray-700",children:[e.jsx("button",{title:"Copy",onClick:()=>z(t),className:"hover:text-primary-100",children:e.jsx(S,{icon:"akar-icons:copy",width:20,height:20})}),e.jsx(Y,{href:`/shorten/${t.id}/edit`,title:"Edit",className:"hover:text-primary-100",children:e.jsx(S,{icon:"iconamoon:edit-light",width:20,height:20})}),e.jsx("button",{title:"Delete",onClick:()=>F(t),className:"hover:text-primary-100",children:e.jsx(S,{icon:"gravity-ui:trash-bin",width:20,height:20})}),e.jsx("button",{title:"Share",onClick:()=>G(t),className:"hover:text-primary-100",children:e.jsx(S,{icon:"tabler:share",width:20,height:20})})]})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:m?6:5,className:"px-4 py-6 text-center text-gray-500",children:"No links available yet."})})})]})}),e.jsx(re,{pagination:{current_page:r.current_page,last_page:r.last_page,from:r.from,to:r.to,total:r.total,prev_page_url:r.prev_page_url,next_page_url:r.next_page_url},perPage:C,onPageChange:K,onPerPageChange:W}),b&&e.jsx(le,{isOpen:b,onClose:()=>g(!1),onConfirm:H}),N&&e.jsx(oe,{url:_,onClose:()=>v(!1)}),e.jsx(ie,{show:h,onClose:()=>d(!1),onSubmit:R,data:U,setData:B,errors:T,processing:M,post:D,reset:L})]})]})}export{we as default};
