import{j as e,r as l,u as A,c as Q,b as V,H as Y,L as Z}from"./app-BFg2P5Wj.js";import{D as ee}from"./DashboardLayout-4fJ9hrIz.js";import{d as w}from"./index-B-NIXFdN.js";import{S as te,B as se,P as re}from"./BulkAction-D7P3iHnE.js";import{S as ae}from"./ButtonShort-DIFxLCbJ.js";import{P as le}from"./PrimaryButton-TVen-bbm.js";import{N as $}from"./Notification-BwZVfdfk.js";import{D as oe}from"./DeleteModal-BAt4GIh7.js";import{S as ne}from"./ShareModal-CUuIT94B.js";import{I as k}from"./iconify-DMzbdefQ.js";/* empty css            */import"./index-DMJx3FTh.js";function ie({className:r="",disabled:g,loading:d=!1,children:m="AI Suggest",...o}){return e.jsx("button",{...o,disabled:g||d,className:`w-full flex justify-center items-center rounded-lg border border-transparent bg-primary-100 px-4 py-3 text-sm font-semibold text-white transition duration-150 ease-in-out hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 
                 ${g||d?"opacity-50 cursor-not-allowed":""} `+r,children:d?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),"Generating..."]}):m})}function ce({show:r,onClose:g,domains:d=[]}){var y;const[m,o]=l.useState(null),[f,b]=l.useState(!1),[x,u]=l.useState(!1),{data:i,setData:c,post:v,processing:p,errors:n,reset:j,clearErrors:S}=A({domain_id:"",original_url:"",custom_alias:"",expires_at:"",password:""});if(!r)return null;const _=()=>{j(),S(),o(null),u(!1),g()},C=s=>{s.preventDefault(),o(null),x||c("password",""),v(route("shorten.store"),{onSuccess:()=>{o({type:"success",message:"Shortened successfully."}),j(),S(),u(!1),g()},onError:()=>{o({type:"error",message:"An error occurred, please check your input."})}})},D=async()=>{var s;if(!i.original_url){o({type:"error",message:"Isi Long URL dulu!"});return}try{b(!0);const h=await Q.post("/ai/slug",{url:i.original_url},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});(s=h.data)!=null&&s.slug?(c("custom_alias",h.data.slug),o({type:"success",message:"AI successfully generated slug."})):o({type:"error",message:"AI does not return slugs."})}catch(h){console.error(h),o({type:"error",message:"Failed to generate slug from AI."})}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-5",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm md:max-w-2xl p-5 md:p-10 relative",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex flex-row",children:[e.jsx("img",{src:"/images/Hyperlink.png",style:{width:"24px",height:"24px"},alt:"hyperlink"}),e.jsx("h2",{className:"text-sm md:text-xl ms-4 font-semibold text-primary-100 mb-4",children:"Shortened Link"})]}),e.jsx("button",{onClick:_,className:"text-foreground font-black hover:text-primary-100 w-2 h-2 md:w-4 md:h-4",children:"âœ•"})]}),m&&e.jsx($,{type:m.type,message:m.message,onClose:()=>o(null)}),e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Domain"}),e.jsxs("select",{name:"domain_id",value:i.domain_id,onChange:s=>c("domain_id",s.target.value),className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",required:!0,children:[e.jsx("option",{value:"",children:"-- Select Domain --"}),d.map(s=>e.jsx("option",{value:s.id,children:s.domain},s.id))]}),n.domain_id&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:n.domain_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Long URL"}),e.jsx("input",{type:"url",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1",placeholder:"https://example.com/",name:"original_url",value:i.original_url,onChange:s=>c("original_url",s.target.value),required:!0}),n.original_url&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:n.original_url})]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:gap-0",children:[e.jsxs("div",{className:"w-full md:basis-3/4 md:me-4",children:[e.jsx("label",{className:"text-sm text-foreground",children:"Short URL"}),e.jsx("input",{type:"text",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",value:`${i.domain_id?(y=d.find(s=>s.id==i.domain_id))==null?void 0:y.domain.replace(/\/+$/,""):window.location.origin}/s/${i.custom_alias||""}`,readOnly:!0})]}),e.jsxs("div",{className:"w-full md:basis-3/4",children:[e.jsx("label",{className:"text-sm text-foreground",children:"Alias"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1 bg-white text-gray-700",placeholder:"custom-alias",name:"custom_alias",value:i.custom_alias,onChange:s=>c("custom_alias",s.target.value)}),e.jsx(ie,{onClick:D,loading:f,className:"mt-1"})]}),n.custom_alias&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:n.custom_alias})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-foreground",children:"Expiration Date"}),e.jsx("input",{type:"date",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-1",name:"expires_at",value:i.expires_at,onChange:s=>c("expires_at",s.target.value),required:!0}),n.expires_at&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:n.expires_at})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-foreground",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:s=>u(s.target.checked)}),"Protect with Password?"]}),x&&e.jsx("input",{type:"password",className:"w-full border border-brfourth rounded-lg px-3 py-2 mt-2",placeholder:"Enter password",name:"password",value:i.password,onChange:s=>c("password",s.target.value)}),n.password&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:n.password})]}),e.jsx(le,{type:"submit",disabled:p,children:p?"Shortened Link...":"Shortened Link"})]})})]})})}function Ne({shortends:r,domains:g}){const{success:d}=V().props,[m,o]=l.useState(""),[f,b]=l.useState(!1),[x,u]=l.useState([]),[i,c]=l.useState(!1),[v,p]=l.useState(!1),[n,j]=l.useState(null),[S,_]=l.useState(!1),[C,D]=l.useState(""),[y,s]=l.useState(null),[h,U]=l.useState(Number(new URLSearchParams(window.location.search).get("perPage"))||10);l.useEffect(()=>{d&&(s({type:"success",message:d}),w.Inertia.replace(window.location.pathname+window.location.search))},[d]);const{data:B,setData:M,post:L,processing:T,errors:R,reset:P}=A({original_url:"",custom_alias:"",expires_at:""}),E=t=>{if(!t)return"Active";const a=new Date;return new Date(t)<a?"Expired":"Active"},O=t=>{t.preventDefault(),L("/shorten.store",{onSuccess:()=>{c(!1),P()}})},F=t=>{u(a=>a.includes(t)?a.filter(N=>N!==t):[...a,t])},q=t=>{j(t),p(!0)},H=()=>{n?w.Inertia.delete(`/shorten/${n.id}`,{onSuccess:()=>{p(!1),j(null),s({type:"success",message:"Link deleted successfully."})},onError:()=>{s({type:"error",message:"Failed to delete link. Please try again."}),p(!1),j(null)},preserveScroll:!0}):p(!1)},z=()=>{if(x.length===0){s({type:"error",message:"No links selected."});return}window.confirm("Are you sure you want to delete selected links?")&&w.Inertia.post("/shorten/bulk-delete",{ids:x,_method:"DELETE"},{onSuccess:()=>{s({type:"success",message:"Selected links deleted successfully."}),u([]),b(!1)},onError:()=>{s({type:"error",message:"Failed to delete selected links."})},preserveScroll:!0})},G=t=>{const a=`${window.location.origin}/s/${t.short_code}`;navigator.clipboard.writeText(a).then(()=>{s({type:"success",message:"Link copied to clipboard!"})}).catch(()=>{s({type:"error",message:"Failed to copy the link."})})},K=t=>{const a=`${window.location.origin}/s/${t.short_code}`;D(a),_(!0)},W=t=>{w.Inertia.get("/shorten",{page:t,perPage:h,search:m},{preserveState:!0,replace:!0})},X=t=>{U(t),w.Inertia.get("/shorten",{page:1,perPage:t,search:m},{preserveState:!0,replace:!0})},J=t=>{o(t),w.Inertia.get("/shorten",{page:1,perPage:h,search:t},{preserveState:!0,replace:!0})};return e.jsxs(ee,{children:[e.jsx(Y,{title:"Shortened Links"}),e.jsxs("div",{className:"py-5",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-primary-100",children:"Shortened Link"}),e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-5 my-3",children:[e.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"List Shortened Link"}),e.jsxs("div",{className:"flex items-center gap-3 transition-all duration-300 ease-in-out flex-wrap",children:[e.jsx("div",{className:"transition-all duration-300",children:e.jsx(ae,{onClick:()=>c(!0)})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsx(te,{onSearch:J})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsx(se,{isActive:f,toggleBulkMode:()=>{b(!f),u([])},onDelete:z})})]})]}),y&&e.jsx($,{type:y.type,message:y.message,onClose:()=>s(null)}),e.jsx("div",{className:"overflow-x-auto bg-white shadow rounded-2xl",children:e.jsxs("table",{className:"min-w-full text-left border-collapse text-sm  md:text-[16px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-muted hover:bg-gray-50",children:[f&&e.jsx("th",{className:"px-4 py-6",children:e.jsx("input",{type:"checkbox",checked:x.length===r.data.length&&r.data.length>0,onChange:t=>{t.target.checked?u(r.data.map(a=>a.id)):u([])}})}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"URL"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Date Created"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Expiration Date"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-6 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:r.data.length>0?r.data.map(t=>{var a,N;return e.jsxs("tr",{className:"border-b border-muted hover:bg-gray-50",children:[f&&e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:x.includes(t.id),onChange:()=>F(t.id)})}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap flex items-center gap-2 w-full max-w-full md:max-w-[560px] overflow-hidden",children:[e.jsx("img",{src:`https://www.google.com/s2/favicons?sz=64&domain=${new URL(t.original_url).hostname}`,alt:"favicon",className:"w-8 h-8 rounded-full bg-gray-100 object-contain",style:{flexShrink:0},onError:I=>{I.currentTarget.onerror=null,I.currentTarget.src="https://cdn-icons-png.flaticon.com/512/565/565547.png"}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("a",{href:t.full_short_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-foreground hover:underline block overflow-hidden text-ellipsis whitespace-nowrap",children:t.full_short_url}),e.jsx("a",{href:t.original_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-foreground break-all hover:underline block",title:t.original_url,children:t.original_url.length>60?`${t.original_url.slice(0,60)}...`:t.original_url})]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:(a=t.created_at)==null?void 0:a.slice(0,10)}),e.jsx("td",{className:"px-4 py-4",children:(N=t.expires_at)==null?void 0:N.slice(0,10)}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${E(t.expires_at)==="Expired"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:E(t.expires_at)})}),e.jsxs("td",{className:"px-4 py-4 flex space-x-2 text-lg text-gray-700",children:[e.jsx("button",{title:"Copy",onClick:()=>G(t),className:"hover:text-primary-100",children:e.jsx(k,{icon:"akar-icons:copy",width:20,height:20})}),e.jsx(Z,{href:`/shorten/${t.id}/edit`,title:"Edit",className:"hover:text-primary-100",children:e.jsx(k,{icon:"iconamoon:edit-light",width:20,height:20})}),e.jsx("button",{title:"Delete",onClick:()=>q(t),className:"hover:text-primary-100",children:e.jsx(k,{icon:"gravity-ui:trash-bin",width:20,height:20})}),e.jsx("button",{title:"Share",onClick:()=>K(t),className:"hover:text-primary-100",children:e.jsx(k,{icon:"tabler:share",width:20,height:20})})]})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:f?6:5,className:"px-4 py-6 text-center text-gray-500",children:"No links available yet."})})})]})}),e.jsx(re,{pagination:{current_page:r.current_page,last_page:r.last_page,from:r.from,to:r.to,total:r.total,prev_page_url:r.prev_page_url,next_page_url:r.next_page_url},perPage:h,onPageChange:W,onPerPageChange:X}),v&&e.jsx(oe,{isOpen:v,onClose:()=>p(!1),onConfirm:H}),S&&e.jsx(ne,{url:C,onClose:()=>_(!1)}),e.jsx(ce,{show:i,onClose:()=>c(!1),onSubmit:O,data:B,setData:M,errors:R,processing:T,post:L,reset:P,domains:g})]})]})}export{Ne as default};
